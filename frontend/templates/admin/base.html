{% extends "admin/base.html" %}
{% load static %}

{% block extrastyle %}
{{ block.super }}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
<style>
    /* Bouton flottant IA */
    .ai-floating-btn {
        position: fixed !important;
        bottom: 30px !important;
        right: 30px !important;
        width: 70px !important;
        height: 70px !important;
        border-radius: 50% !important;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
        color: white !important;
        border: none !important;
        box-shadow: 0 4px 20px rgba(102, 126, 234, 0.4) !important;
        cursor: pointer !important;
        z-index: 99999 !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        font-size: 2rem !important;
        transition: all 0.3s ease !important;
        animation: pulse 2s infinite !important;
    }
    
    .ai-floating-btn:hover {
        transform: scale(1.1);
        box-shadow: 0 6px 30px rgba(102, 126, 234, 0.6);
    }
    
    @keyframes pulse {
        0%, 100% {
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.4);
        }
        50% {
            box-shadow: 0 4px 30px rgba(102, 126, 234, 0.8);
        }
    }
    
    /* Modal pour l'analyse */
    .ai-modal {
        display: none;
        position: fixed;
        z-index: 10000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.5);
        animation: fadeIn 0.3s;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    
    .ai-modal-content {
        background-color: #fefefe;
        margin: 5% auto;
        padding: 0;
        border: none;
        border-radius: 15px;
        width: 90%;
        max-width: 1200px;
        max-height: 85vh;
        overflow-y: auto;
        box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        animation: slideDown 0.3s;
    }
    
    @keyframes slideDown {
        from {
            transform: translateY(-50px);
            opacity: 0;
        }
        to {
            transform: translateY(0);
            opacity: 1;
        }
    }
    
    .ai-modal-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 20px 30px;
        border-radius: 15px 15px 0 0;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .ai-modal-header h2 {
        margin: 0;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .ai-modal-close {
        color: white;
        font-size: 2rem;
        font-weight: bold;
        cursor: pointer;
        background: rgba(255,255,255,0.2);
        border-radius: 50%;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s;
    }
    
    .ai-modal-close:hover {
        background: rgba(255,255,255,0.3);
        transform: rotate(90deg);
    }
    
    .ai-modal-body {
        padding: 30px;
    }
</style>
{% endblock %}

{% block content %}
{{ block.super }}

<!-- Bouton flottant IA -->
<button class="ai-floating-btn" onclick="openAIModal()" title="Analyse IA des revenus et passagers">
    <i class="bi bi-robot"></i>
</button>

<!-- Modal d'analyse IA -->
<div id="aiModal" class="ai-modal">
    <div class="ai-modal-content">
        <div class="ai-modal-header">
            <h2>
                <i class="bi bi-robot"></i>
                Analyse IA - Revenus & Passagers
            </h2>
            <span class="ai-modal-close" onclick="closeAIModal()">&times;</span>
        </div>
        <div class="ai-modal-body" id="aiModalBody">
            <div style="text-align: center; padding: 40px;">
                <i class="bi bi-hourglass-split" style="font-size: 3rem; color: #667eea;"></i>
                <p>Chargement de l'analyse...</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extrahead %}
{{ block.super }}
<script src="{% static 'admin/js/ai_floating_button.js' %}"></script>
{% endblock %}

